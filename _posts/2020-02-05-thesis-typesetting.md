---
date: 2020-02-05 10:23:17+00:00
layout: post
title: 论文排版
categories: CAT
tags: 
---

本文主要讲下北大硕士论文排版时遇到的几个问题和解决办法，主要参考了软微官网提供的[硕士论文模板及写作指南](http://www.ss.pku.edu.cn/index.php/education/edunotice/2623-硕士论文模板及写作指南)。

1. 自动多级列表与题注

	软微给的模板没有给标题设定自动列表，这样不便于自动编号以及生成题注。

	在Word中定义新的多级列表，将级别链接到样式，级别1到3对应于标题1到3。注意标题1到3的缩进都是一样的。论文指南要求编号和标题之间空一汉字符，这里我没有进行设置，选择手动添加，详见本文第6条。

	![](/album/thesis/list.jpg)

	同时修改页眉，用域代码添加编号和章节名，中间隔一个汉字符。

	![](/album/thesis/header.jpg)

	因为北大硕士论文要求一级标题用“第一章”这样的形式，生成的题注会变成图一.1这样的形式。

	这里有一个折中的办法，就是先使用数字编号（勾选正规形式编号），这样生成的题注就是图1.1这样的了。要导出论文时把编号再改成中文的，这时题注的域还没有更新，仍然是数字编号。但导出PDF时会自动更新所有域，还是会变回去。这时我们可以选中所有域，使用快捷键CTRL+F11锁定域，避免其进行更新。要解锁则使用快捷键CTRL+SHIFT+F11，要更新全部域使用快捷键F9。

2. 样式

	论文中的样式可以分为几种：标题1到3、论文正文、图、表、图注、表注、参考文献、表达式。最好单独设置这些样式。

	目录的样式可以使用自定义目录样式进行设置。
	
	存在一个表的段前段后距离的设置问题，因为表样式是给表里的文字设置的，按照要求设置后表本身和论文正文的间距过窄。我只有手动添加换行。

3. 公式

	软微给的模板是doc格式，最新版本的Word打开后不能添加公式。一个折中方法是新建一个docx格式的文档用于写公式，之后再复制到doc中，公式会另存为图片。

4. 代码

	论文中需要插入代码，我选择用<http://www.planetb.ca/syntax-highlight-word>这个网站对代码进行高亮，然后直接复制到Word里使用。但代码块和正文之间的间距在写作指南里没有说明，我暂时设了一个0.5行。

5. 参考文献

	参考文献有两种格式：顺序编码制和著者-出版年制。“顺序编码制” 是指正文中索引文献时，用顺序编号的方法标注文献。文献序号放“[ ]” 内，以上标方式标注在索引位置。 “著者-出版年制” 是指索引文献处用文献著者和出版年度标注文献，一般著者和出版年度放“（ ） ” 内， 以逗号分隔，标注在索引位置。以“顺序编码制” 索引文献时，其参考文献应按索引对应编号顺序著录。以“著者-出版年制” 索引文献时，参考文献应按文种分类著录，按著者字母顺序排序，中文文献放前方。
	
	参考文献的条目格式都遵循国家标准GB/T 7714—2005。
	
	我个人倾向于使用顺序编码。
	
	可以使用EndNote管理文献，网上有一份国家标准的参考文献样式可以使用：<https://cnzhx.net/blog/endnote-output-style-cnzhx/>。注意中文三个以上作者需要把et al改成等，然后最后参考文献列表的编号是纯文本，不是用的Word中的编号，会有对齐问题，最好把文字编号删了然后用Word的编号功能重新进行编号。
	
6. 序号后的空格问题

	论文指南要求目录、标题、题注（图序、表序）中的序号和文字之间留一个汉字符。一个汉字符对应一个全角空格，两个英文空格。
	另外，指南还要求题注的标签和序号之间不能有空格。需要注意的是Word对汉语的支持不好，添加的题注标签和序号之间必须有空格。
	
	这时只有根据样式先选中所有这类文本后再进行空格的删除或者替换操作。
	
	替换示例：
	
	原文：图 1-1 题注文本（English Text）
	
	替换后：图1-1　题注文本（English Text）
	
	“图”后面的空格比较好处理，直接搜索图加空格就行。比较麻烦的是序号后面的单个英文空格替换为两个空格的问题。如果题注包含英文，替换空格时比较麻烦。可以先将英文单词间的空格替换为一个特殊符号，替换好后再把特殊符号换回空格。替换代码（使用通配符）：
	
	```
	搜索：([a-zA-Z]) ([a-zA-Z])
    替换：\1PLACEHOLDER\2
	```
	
7. 脚注

	注意脚注的横线分隔符的缩进。具体修改方法参见：[Word 2010如何修改脚注上方的横线?](http://www.360doc.com/content/18/0412/02/9360021_744894414.shtml)

	![](/album/thesis/footnote.png)

8. 版权声明与原创性声明页

	版权声明与原创性声明页使用北大系统上下载的PDF。将Word导出为PDF后再用Adobe Acrobat等PDF编辑软件替换页面。
	
	
注意事项：

1. 新的章节应该出现在奇数页
2. 文中的括号使用全角括号
3. 参考文献里的逗号使用半角，后面跟随一个空格
4. 编号列表中的文本可以不设置悬挂缩进
5. 待补充……

下载：

修改后的模板：[模板.doc](/download/模板.doc)

修改后的EndNote用国家标准参考文献样式：[geebinf modified by zz.ens](/download/geebinf%20modified%20by%20zz.ens)

相关：

[使用Git管理Word格式的论文](/use-git-with-thesis-in-word-format/)


参考资料：

* [Word文档中禁止目录、时间、参考文献等域的自动更新](https://www.jianshu.com/p/a51872411ca4)
* [Word中批量更新域的两个小方法](https://blog.csdn.net/silencemaster/article/details/80714333)
* [论文写作心得-格式与自动化工具使用篇](http://blog.xulihang.me/bachelor-degree-paper-notes-office-automation/)